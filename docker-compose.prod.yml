version: '3'

services:
  view:
    container_name: 'view'
    build:
      context: .docker
      dockerfile: view.Dockerfile
    ports:
      - '3000:3000'
    volumes:
      - ./view:/app/next-project
    environment:
      CSR_VIEW_URI: 'http://lottery.nutfes.net'
    command: bash -c 'npm run build && npm run start'
    depends_on:
      - go
    tty: true

  go:
    container_name: 'ST-GO'
    build:
      context: .docker
      dockerfile: go.Dockerfile
    volumes:
      - ./go_api:/usr/local/go/src/api
    env_file:
      - lottery.env
    ports:
      - '1323:1323'
    command: './start.sh'
